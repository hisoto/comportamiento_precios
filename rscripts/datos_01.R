# Objetivo: Prueba de comportamiento de precios con Positron

# Autor: Héctor Iván Soto Parra

#_____________________________________________________________

rm(list = ls())
gc()

pacman:::p_load(tidyverse,
                haven,
                janitor,
                rvest,
                httr2,
                xml2,
                tibble,
                purrr,
                writexl)

temp <- tibble(
  variable = c(
    "INPC",
    "Subyacente",
    "INPC CCM",
    "No subyacente",
    "INPC quincenal",
    "INPC quincenal subyacente",
    "INPC quincenal nsubyacente",
    "Tortilla",
    "Huevo",
    "Leche",
    "Carne res",
    "Frijol",
    "INPP sin petróleo",
    "INPP primarias",
    "INPP secundarias sin petróleo",
    "INPP terciarias",
    "INPP finales",
    "INPP intermedios",
    "Área Met. de la CDMX",
    "Acapulco, Gro.",
    "Aguascalientes, Ags.",
    "Atlacomulco, Méx.",
    "Campeche, Camp.",
    "Cancún, Q. Roo.",
    "Cd. Acuña, Coah.",
    "Cd. Jiménez, Chih.",
    "Cd. Juárez, Chih.",
    "Chetumal, Q.R.",
    "Chihuahua, Chih.",
    "Coatzacoalcos, Ver.",
    "Colima, Col.",
    "Córdoba, Ver.",
    "Cortazar, Gto.",
    "Cuernavaca, Mor.",
    "Culiacán, Sin.",
    "Durango, Dgo.",
    "Esperanza, Son.",
    "Fresnillo, Zac.",
    "Guadalajara, Jal.",
    "Hermosillo, Son.",
    "Huatabampo, Son.",
    "Iguala, Gro.",
    "Izúcar de Matamoros, Pue.",
    "Jacona, Mich.",
    "La Paz, B.C.S.",
    "León, Gto.",
    "Matamoros, Tamps.",
    "Mérida, Yuc.",
    "Mexicali, B.C.",
    "Monclova, Coah.",
    "Monterrey, N.L.",
    "Morelia, Mich.",
    "Oaxaca, Oax.",
    "Pachuca, Hgo.",
    "Puebla, Pue.",
    "Querétaro, Qro.",
    "Saltillo, Coah.",
    "San Andrés Tuxtla, Ver.",
    "San Luis Potosí, S.L.P.",
    "Tampico, Tamps.",
    "Tapachula, Chis.",
    "Tehuantepec, Oax.",
    "Tepatitlán, Jal.",
    "Tepic, Nay.",
    "Tijuana, B.C.",
    "Tlaxcala, Tlax.",
    "Toluca, Edo. de Méx.",
    "Torreón, Coah.",
    "Tulancingo, Hgo.",
    "Tuxtla Gutiérrez, Chis.",
    "Veracruz, Ver.",
    "Villahermosa, Tab.",
    "Zacatecas, Zac.",
    "Nacional"
  ),
  idEstructura = c(
    "112001700010",
    "112001700010",
    "112001700010",
    "112001700010",
    "112001600020",
    "112001600020",
    "112001600020",
    "112001700030",
    "112001700030",
    "112001700030",
    "112001700030",
    "112001700030",
    "112001900050",
    "112001900050",
    "112001900050",
    "112001900050",
    "1120019000300020",
    "1120019000400010",
    "1120017000600010",
    "1120017000600020",
    "1120017000600030",
    "1120017000600040",
    "1120017000600050",
    "1120017000600060",
    "1120017000600070",
    "1120017000600080",
    "1120017000600090",
    "1120017000600100",
    "1120017000600110",
    "1120017000600120",
    "1120017000600130",
    "1120017000600140",
    "1120017000600150",
    "1120017000600160",
    "1120017000600170",
    "1120017000600180",
    "1120017000600190",
    "1120017000600200",
    "1120017000600210",
    "1120017000600220",
    "1120017000600230",
    "1120017000600240",
    "1120017000600250",
    "1120017000600260",
    "1120017000600270",
    "1120017000600280",
    "1120017000600290",
    "1120017000600300",
    "1120017000600310",
    "1120017000600320",
    "1120017000600330",
    "1120017000600340",
    "1120017000600350",
    "1120017000600360",
    "1120017000600370",
    "1120017000600380",
    "1120017000600390",
    "1120017000600400",
    "1120017000600410",
    "1120017000600420",
    "1120017000600430",
    "1120017000600440",
    "1120017000600450",
    "1120017000600460",
    "1120017000600470",
    "1120017000600480",
    "1120017000600490",
    "1120017000600500",
    "1120017000600510",
    "1120017000600520",
    "1120017000600530",
    "1120017000600540",
    "1120017000600550",
    "112001700010"
  ),
  series = c(
    "e|865541",
    "e|865542",
    "e|865543",
    "e|865555",
    "e|821890",
    "e|821891",
    "e|821901",
    "e|865594",
    "e|865663",
    "e|865647",
    "e|865625",
    "e|865706",
    "e|1700001",
    "e|1700003",
    "e|1700160",
    "e|1701070",
    "e|1380005",
    "e|1750002",
    "e|870982",
    "e|871518",
    "e|871948",
    "e|872378",
    "e|872808",
    "e|873238",
    "e|873668",
    "e|874098",
    "e|874528",
    "e|874958",
    "e|875388",
    "e|875818",
    "e|876248",
    "e|876678",
    "e|877108",
    "e|877538",
    "e|877968",
    "e|878398",
    "e|878828",
    "e|879258",
    "e|879688",
    "e|880224",
    "e|880654",
    "e|881084",
    "e|881514",
    "e|881944",
    "e|882374",
    "e|882804",
    "e|883234",
    "e|883664",
    "e|884094",
    "e|884524",
    "e|884954",
    "e|885490",
    "e|885920",
    "e|886350",
    "e|886780",
    "e|887210",
    "e|887640",
    "e|888070",
    "e|888500",
    "e|888930",
    "e|889360",
    "e|889790",
    "e|890220",
    "e|890650",
    "e|891080",
    "e|891510",
    "e|891940",
    "e|892370",
    "e|892800",
    "e|893230",
    "e|893660",
    "e|894090",
    "e|894520",
    "e|865541"
  )
)

temp <- temp %>%
  mutate(
    api = case_when(
      variable == "INPC"                        ~ "v_inpc",
      variable == "Subyacente"                  ~ "v_subyacente",
      variable == "No subyacente"               ~ "v_inpc_nsubyacente",
      variable == "INPC CCM"                    ~ "v_inpc_ccm",
      variable == "INPC quincenal"              ~ "v_inpc_quincenal",
      variable == "INPC quincenal subyacente"   ~ "v_subyacente_quincenal",
      variable == "INPC quincenal nsubyacente"  ~ "v_nsubyacente_quincenal",
      variable == "Tortilla"                     ~ "v_tortilla",
      variable == "Frijol"                       ~ "v_frijol",
      variable == "Huevo"                        ~ "v_huevo",
      variable == "Leche"                        ~ "v_leche",
      variable == "Carne res"                   ~ "v_carne_res",
      variable == "INPP sin petróleo"           ~ "v_inpp",
      variable == "INPP primarias"              ~ "v_inpp_primarias",
      variable == "INPP secundarias sin petróleo" ~ "v_inpp_secundarias",
      variable == "INPP terciarias"             ~ "v_inpp_terciarias",
      variable == "INPP finales"                ~ "v_inpp_finales",
      variable == "INPP intermedios"            ~ "v_inpp_intermedios",
      variable == "Área Met. de la CDMX"        ~ "v_ciudad_870982",
      variable == "Acapulco, Gro."              ~ "v_ciudad_871518",
      variable == "Aguascalientes, Ags."        ~ "v_ciudad_871948",
      variable == "Atlacomulco, Méx."         ~ "v_ciudad_872378",
      variable == "Campeche, Camp."           ~ "v_ciudad_872808",
      variable == "Cancún, Q. Roo."           ~ "v_ciudad_873238",
      variable == "Cd. Acuña, Coah."          ~ "v_ciudad_873668",
      variable == "Cd. Jiménez, Chih."        ~ "v_ciudad_874098",
      variable == "Cd. Juárez, Chih."         ~ "v_ciudad_874528",
      variable == "Chetumal, Q.R."            ~ "v_ciudad_876248",
      variable == "Chihuahua, Chih."          ~ "v_ciudad_876678",
      variable == "Coatzacoalcos, Ver."       ~ "v_ciudad_877108",
      variable == "Colima, Col."              ~ "v_ciudad_877538",
      variable == "Córdoba, Ver."             ~ "v_ciudad_877968",
      variable == "Cortazar, Gto."            ~ "v_ciudad_874958",
      variable == "Cuernavaca, Mor."          ~ "v_ciudad_875388",
      variable == "Culiacán, Sin."            ~ "v_ciudad_875818",
      variable == "Durango, Dgo."             ~ "v_ciudad_878398",
      variable == "Esperanza, Son."           ~ "v_ciudad_878828",
      variable == "Fresnillo, Zac."           ~ "v_ciudad_879258",
      variable == "Guadalajara, Jal."         ~ "v_ciudad_879688",
      variable == "Hermosillo, Son."          ~ "v_ciudad_880224",
      variable == "Huatabampo, Son."          ~ "v_ciudad_880654",
      variable == "Iguala, Gro."              ~ "v_ciudad_881084",
      variable == "Izúcar de Matamoros, Pue." ~ "v_ciudad_881514",
      variable == "Jacona, Mich."            ~ "v_ciudad_881944",
      variable == "La Paz, B.C.S."           ~ "v_ciudad_882374",
      variable == "León, Gto."               ~ "v_ciudad_882804",
      variable == "Matamoros, Tamps."        ~ "v_ciudad_883234",
      variable == "Mérida, Yuc."            ~ "v_ciudad_883664",
      variable == "Mexicali, B.C."          ~ "v_ciudad_884094",
      variable == "Monclova, Coah."         ~ "v_ciudad_884524",
      variable == "Monterrey, N.L."         ~ "v_ciudad_884954",
      variable == "Morelia, Mich."          ~ "v_ciudad_885490",
      variable == "Oaxaca, Oax."           ~ "v_ciudad_885920",
      variable == "Pachuca, Hgo."          ~ "v_ciudad_886350",
      variable == "Puebla, Pue."           ~ "v_ciudad_886780",
      variable == "Querétaro, Qro."       ~ "v_ciudad_887210",
      variable == "Saltillo, Coah."       ~ "v_ciudad_887640",
      variable == "San Andrés Tuxtla, Ver." ~ "v_ciudad_888070",
      variable == "San Luis Potosí, S.L.P."  ~ "v_ciudad_888500",
      variable == "Tampico, Tamps."         ~ "v_ciudad_888930",
      variable == "Tapachula, Chis."       ~ "v_ciudad_889360",
      variable == "Tehuantepec, Oax."     ~ "v_ciudad_889790",
      variable == "Tepatitlán, Jal."      ~ "v_ciudad_890220",
      variable == "Tepic, Nay."          ~ "v_ciudad_890650",
      variable == "Tijuana, B.C."       ~ "v_ciudad_891080",
      variable == "Tlaxcala, Tlax."     ~ "v_ciudad_891510",
      variable == "Toluca, Edo. de Méx."    ~ "v_ciudad_891940",
      variable == "Torreón, Coah."         ~ "v_ciudad_892370",
      variable == "Tulancingo, Hgo."      ~ "v_ciudad_892800",
      variable == "Tuxtla Gutiérrez, Chis." ~ "v_ciudad_893230",
      variable == "Veracruz, Ver."         ~ "v_ciudad_893660",
      variable == "Villahermosa, Tab."     ~ "v_ciudad_894090",
      variable == "Zacatecas, Zac."       ~ "v_ciudad_894520",
      variable == "Nacional"               ~ "v_ciudad_inpc",
      TRUE ~ NA_character_
    )
  )


writexl::write_xlsx(temp, "data/inpc_api.xlsx")
